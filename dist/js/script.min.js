function debug(a) {
    console.log(a);
}

function BaseRelation(a) {
    this.name = a;
}

function getAttrsFromTable(a) {
    for (var b = a.getElementsByTagName("th"), c = new Array(b.length), d = 0; d < b.length; d++) c[d] = b[d].innerHTML;
    return c;
}

function rowToTuple(a, b) {
    for (var c = {}, d = a.getElementsByTagName("td"), e = 0; e < b.length; e++) c[b[e]] = d[e].innerHTML;
    return c;
}

function getTuples(a, b) {
    for (var c = a.getElementsByTagName("tbody")[0].getElementsByTagName("tr"), d = new Array(c.length), e = 0; e < c.length; e++) d[e] = rowToTuple(c[e], b);
    return d;
}

function findTable(a) {
    for (var b = document.getElementsByClassName("relation"), c = 0; c < b.length; c++) {
        var d = b[c].getElementsByTagName("caption")[0];
        if (0 === d.innerText.indexOf(a)) return b[c];
    }
    throw "No such relation defined";
}

function Cross(a, b) {
    this.left = a, this.right = b;
}

function NaturalJoin(a, b) {
    this.left = a, this.right = b;
}

function getJoinAttrs(a, b) {
    joinAttrs = [];
    for (var c = 0; c < a.length; c++) -1 != b.indexOf(a[c]) && joinAttrs.push(a[c]);
    return joinAttrs;
}

function Projection(a, b) {
    this.attrs = a, this.relation = b;
}

function RelationRenaming(a, b) {
    this.new_name = a, this.relation = b;
}

function ColumnRenaming(a, b) {
    this.renaming = a, this.relation = b;
}

function Selection(a, b) {
    this.predicate = a, this.relation = b;
}

function BaseRelation(a) {
    this.name = a;
}

function Selection(a, b) {
    this.predicate = a, this.relation = b;
}

function Projection(a, b) {
    this.attrlist = a, this.relation = b;
}

function RelationRenaming(a, b) {
    this.new_name = a, this.relation = b;
}

function ColumnRenaming(a, b) {
    this.renaming = a, this.relation = b;
}

function Cross(a, b) {
    this.left = a, this.right = b;
}

function NaturalJoin(a, b) {
    this.left = a, this.right = b;
}

function ThetaJoin(a, b, c) {
    this.left = a, this.right = b, this.pred = c;
}

function applyProjection(a, b, c) {
    for (var d = getAttrsFromTable(a), e = getTuples(a, d), f = new Array(e.length), g = 0; g < e.length; g++) f[g] = project(e[g], c);
    fillTableWithTuples(b, f, c);
}

function makeTablesExpendable() {
    var a = document.getElementsByClassName("expendable"), b = document.createElement("span");
    b.classList.add("toggle"), b.innerHTML = "▼", b.style.cursor = "s-resize";
    for (var c = 0; c < a.length; c++) {
        hideTable(a[c]);
        var d = a[c].getElementsByTagName("caption")[0], e = b.cloneNode(!0);
        d.appendChild(e), e.onclick = toggleTable, foo = e;
    }
}

function toggleTable() {
    var a = this.parentElement.parentElement, b = a.getElementsByTagName("tbody")[0];
    "none" == b.style.display ? (showTable(a), a.getElementsByClassName("toggle")[0].innerHTML = "▲", 
    a.getElementsByClassName("toggle")[0].style.cursor = "n-resize") : (hideTable(a), 
    a.getElementsByClassName("toggle")[0].innerHTML = "▼", a.getElementsByClassName("toggle")[0].style.cursor = "s-resize");
}

function hideTable(a) {
    var b = a.getElementsByTagName("tbody")[0];
    b.style.display = "none";
}

function showTable(a) {
    var b = a.getElementsByTagName("tbody")[0];
    b.style.display = "";
}

function execQuery() {
    var a = document.getElementById("input").value;
    debug("Onload function called for query: " + a), document.getElementById("error_output").innerHTML = "";
    var b = document.getElementById("result_output").getElementsByTagName("table");
    b.length > 0 && b[0].remove();
    try {
        result = QueryParser.parse(a);
    } catch (c) {
        document.getElementById("error_output").innerHTML = c;
    }
    result.eval();
    var d = result.result, e = result.attrs, f = build_table(d, e);
    document.getElementById("result_output").appendChild(f);
}

function renameAttr(a, b, c) {
    return a[c] && (a[b] = a[c], delete a[c]), a;
}

function applyRename(a, b, c) {
    var d = getAttrsFromTable(a), e = getTuples(a, d), f = new Array(e.length), g = c.match(/(\w+)\s*(<-)\s*(\w+)/);
    if (null == g) for (var h = 0; h < e.length; h++) f[h] = e[h]; else {
        debug(g), debug(d);
        for (var h = 0; h < e.length; h++) f[h] = renameAttr(e[h], g[1], g[3]);
        idx = d.indexOf(g[3]), debug(idx), d[idx] = g[1];
    }
    fillTableWithTuples(b, f, d);
}

function applySelection(a, b, c) {
    for (var d = getAttrsFromTable(a), e = getTuples(a, d), f = [], g = 0; g < e.length; g++) c(e[g]) && f.push(e[g]);
    fillTableWithTuples(b, f, d);
}

function build_table(a, b) {
    var c = document.createElement("table");
    c.classList.add("relation");
    var d = document.createElement("caption");
    d.innerHTML = "RESULT", c.appendChild(d), fillTableHeader(c, b);
    var e = document.createElement("tbody");
    c.appendChild(e);
    for (var f = 0; f < a.length; f++) {
        var g = createRow(a[f], b);
        e.appendChild(g);
    }
    return c;
}

function fillTableHeader(a, b) {
    var c = document.createElement("thead"), d = document.createElement("tr");
    c.appendChild(d);
    for (var e = 0; e < b.length; e++) {
        var f = document.createElement("th");
        f.innerHTML = b[e], d.appendChild(f);
    }
    a.appendChild(c);
}

function createRow(a, b) {
    for (var c = document.createElement("tr"), d = 0; d < b.length; d++) {
        var e = document.createElement("td");
        e.innerHTML = a[b[d]], c.appendChild(e);
    }
    return c;
}

BaseRelation.prototype.eval = function() {
    var a = findTable(this.name);
    this.attrs = getAttrsFromTable(a), this.result = getTuples(a, this.attrs), debug("BaseRelation '" + this.name + "' eval()ed.");
}, Cross.prototype.eval = function() {
    this.left.eval(), this.right.eval();
    var a = this.left.result, b = this.right.result;
    this.attrs = this.left.attrs.concat(this.right.attrs), this.result = new Array();
    for (var c = 0; c < a.length; c++) for (var d = 0; d < b.length; d++) {
        var e = a[c], f = b[d], g = {};
        for (var h in e) g[h] = e[h];
        for (var h in f) g[h] = f[h];
        console.log(g), this.result.push(g);
    }
    console.log(this.result);
}, NaturalJoin.prototype.eval = function() {
    this.left.eval(), this.right.eval();
    var a = this.left.result, b = this.right.result;
    this.join_attrs = getJoinAttrs(this.left.attrs, this.right.attrs), this.result = new Array(), 
    this.attrs = new Array();
    for (var c = 0; c < this.left.attrs.length; c++) {
        var d = this.left.attrs[c];
        -1 == this.join_attrs.indexOf(d) && this.attrs.push(this.left.attrs[c]);
    }
    for (var c = 0; c < this.join_attrs.length; c++) this.attrs.push(this.join_attrs[c]);
    for (var c = 0; c < this.right.attrs.length; c++) {
        var d = this.right.attrs[c];
        -1 == this.join_attrs.indexOf(d) && this.attrs.push(this.right.attrs[c]);
    }
    for (var c = 0; c < a.length; c++) for (var e = 0; e < b.length; e++) {
        for (var f = a[c], g = b[e], h = !0, i = 0; i < this.join_attrs.length; i++) h = h && f[this.join_attrs[i]] == g[this.join_attrs[i]];
        if (h) {
            var j = {};
            for (var d in f) j[d] = f[d];
            for (var d in g) -1 == this.join_attrs.indexOf(d) && (j[d] = g[d]);
            this.result.push(j);
        }
    }
}, Projection.prototype.eval = function() {
    this.relation.eval();
    var a = this.relation.result;
    this.result = new Array();
    for (var b = 0; b < a.length; b++) {
        var c = this.project(a[b]);
        this.result.pushDistinct(c);
    }
    this.result;
}, Projection.prototype.project = function(a) {
    for (var b in a) -1 == this.attrs.indexOf(b) && delete a[b];
    return a;
}, Array.prototype.pushDistinct = function(a) {
    for (var b = 0; b < this.length; b++) {
        var c = !0;
        for (k in this[b]) c = c && this[b][k] == a[k];
        if (c) return this.length;
    }
    this.push(a);
}, RelationRenaming.prototype.eval = function() {
    this.relation.eval();
}, ColumnRenaming.prototype.eval = function() {
    this.relation.eval(), console.log("# ColumnRenaming started"), this.buildAttrs();
    var a = this.relation.result;
    this.result = new Array();
    for (var b = 0; b < a.length; b++) console.log("# cr step " + b), this.result.push(this.applyRenaming(a[b]));
}, ColumnRenaming.prototype.applyRenaming = function(a) {
    var b = {};
    for (var c in a) for (var d = 0; d < this.renaming.length; d++) {
        var e = this.renaming[d].newname;
        this.renaming[d].oldname == c ? b[e] = a[c] : b[c] = a[c];
    }
    return b;
}, ColumnRenaming.prototype.buildAttrs = function() {
    this.attrs = [];
    for (var a = 0; a < this.relation.attrs.length; a++) {
        for (var b = !1, c = 0; c < this.renaming.length; c++) this.relation.attrs[a] == this.renaming[c].oldname && (b = !0, 
        this.attrs.push(this.renaming[c].newname));
        b || this.attrs.push(this.relation.attrs[a]);
    }
    console.log(this.relation.attrs), console.log(this.attrs);
}, Selection.prototype.eval = function() {
    this.relation.eval();
    var a = this.relation.result;
    console.log(this), this.attrs = this.relation.attrs, this.result = new Array();
    for (var b = 0; b < a.length; b++) this.predicate(a[b]) && this.result.push(a[b]);
}, QueryParser = function() {
    function a(a, b) {
        function c() {
            this.constructor = a;
        }
        c.prototype = b.prototype, a.prototype = new c();
    }
    function b(a, b, c, d, e, f) {
        this.message = a, this.expected = b, this.found = c, this.offset = d, this.line = e, 
        this.column = f, this.name = "SyntaxError";
    }
    function c(a) {
        function c(b) {
            function c(b, c, d) {
                var e, f;
                for (e = c; d > e; e++) f = a.charAt(e), "\n" === f ? (b.seenCR || b.line++, b.column = 1, 
                b.seenCR = !1) : "\r" === f || "\u2028" === f || "\u2029" === f ? (b.line++, b.column = 1, 
                b.seenCR = !0) : (b.column++, b.seenCR = !1);
            }
            return Pb !== b && (Pb > b && (Pb = 0, Qb = {
                line: 1,
                column: 1,
                seenCR: !1
            }), c(Qb, Pb, b), Pb = b), Qb;
        }
        function d(a) {
            Rb > Nb || (Nb > Rb && (Rb = Nb, Sb = []), Sb.push(a));
        }
        function e(d, e, f) {
            function g(a) {
                var b = 1;
                for (a.sort(function(a, b) {
                    return a.description < b.description ? -1 : a.description > b.description ? 1 : 0;
                }); b < a.length; ) a[b - 1] === a[b] ? a.splice(b, 1) : b++;
            }
            function h(a, b) {
                function c(a) {
                    function b(a) {
                        return a.charCodeAt(0).toString(16).toUpperCase();
                    }
                    return a.replace(/\\/g, "\\\\").replace(/"/g, '\\"').replace(/\x08/g, "\\b").replace(/\t/g, "\\t").replace(/\n/g, "\\n").replace(/\f/g, "\\f").replace(/\r/g, "\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g, function(a) {
                        return "\\x0" + b(a);
                    }).replace(/[\x10-\x1F\x80-\xFF]/g, function(a) {
                        return "\\x" + b(a);
                    }).replace(/[\u0180-\u0FFF]/g, function(a) {
                        return "\\u0" + b(a);
                    }).replace(/[\u1080-\uFFFF]/g, function(a) {
                        return "\\u" + b(a);
                    });
                }
                var d, e, f, g = new Array(a.length);
                for (f = 0; f < a.length; f++) g[f] = a[f].description;
                return d = a.length > 1 ? g.slice(0, -1).join(", ") + " or " + g[a.length - 1] : g[0], 
                e = b ? '"' + c(b) + '"' : "end of input", "Expected " + d + " but " + e + " found.";
            }
            var i = c(f), j = f < a.length ? a.charAt(f) : null;
            return null !== e && g(e), new b(null !== d ? d : h(e, j), e, j, f, i.line, i.column);
        }
        function f() {
            var a;
            return a = g();
        }
        function g() {
            var a;
            return a = h(), a === y && (a = k(), a === y && (a = o(), a === y && (a = q(), a === y && (a = r(), 
            a === y && (a = u(), a === y && (a = v())))))), a;
        }
        function h() {
            var a, b;
            return a = Nb, b = i(), b !== y && (Ob = a, b = B(b)), a = b;
        }
        function i() {
            var b, c, e;
            if (b = Nb, c = [], D.test(a.charAt(Nb)) ? (e = a.charAt(Nb), Nb++) : (e = y, 0 === Tb && d(E)), 
            e !== y) for (;e !== y; ) c.push(e), D.test(a.charAt(Nb)) ? (e = a.charAt(Nb), Nb++) : (e = y, 
            0 === Tb && d(E)); else c = C;
            return c !== y && (Ob = b, c = F(c)), b = c;
        }
        function j() {
            var b, c, e, f, g;
            if (b = Nb, c = i(), c !== y) if (46 === a.charCodeAt(Nb) ? (e = G, Nb++) : (e = y, 
            0 === Tb && d(H)), e !== y) {
                if (f = [], D.test(a.charAt(Nb)) ? (g = a.charAt(Nb), Nb++) : (g = y, 0 === Tb && d(E)), 
                g !== y) for (;g !== y; ) f.push(g), D.test(a.charAt(Nb)) ? (g = a.charAt(Nb), Nb++) : (g = y, 
                0 === Tb && d(E)); else f = C;
                f !== y ? (Ob = b, c = I(c, f), b = c) : (Nb = b, b = C);
            } else Nb = b, b = C; else Nb = b, b = C;
            if (b === y) {
                if (b = Nb, c = [], D.test(a.charAt(Nb)) ? (e = a.charAt(Nb), Nb++) : (e = y, 0 === Tb && d(E)), 
                e !== y) for (;e !== y; ) c.push(e), D.test(a.charAt(Nb)) ? (e = a.charAt(Nb), Nb++) : (e = y, 
                0 === Tb && d(E)); else c = C;
                c !== y && (Ob = b, c = F(c)), b = c;
            }
            return b;
        }
        function k() {
            var b, c, e, f, h, i;
            return b = Nb, a.substr(Nb, 7) === J ? (c = J, Nb += 7) : (c = y, 0 === Tb && d(K)), 
            c !== y ? (e = l(), e !== y ? (a.substr(Nb, 2) === L ? (f = L, Nb += 2) : (f = y, 
            0 === Tb && d(M)), f !== y ? (h = g(), h !== y ? (41 === a.charCodeAt(Nb) ? (i = N, 
            Nb++) : (i = y, 0 === Tb && d(O)), i !== y ? (Ob = b, c = P(e, h), b = c) : (Nb = b, 
            b = C)) : (Nb = b, b = C)) : (Nb = b, b = C)) : (Nb = b, b = C)) : (Nb = b, b = C), 
            b;
        }
        function l() {
            var b, c, e, f, g, h;
            if (b = Nb, c = n(), c !== y) {
                for (e = [], Q.test(a.charAt(Nb)) ? (f = a.charAt(Nb), Nb++) : (f = y, 0 === Tb && d(R)); f !== y; ) e.push(f), 
                Q.test(a.charAt(Nb)) ? (f = a.charAt(Nb), Nb++) : (f = y, 0 === Tb && d(R));
                if (e !== y) if (f = m(), f !== y) {
                    for (g = [], Q.test(a.charAt(Nb)) ? (h = a.charAt(Nb), Nb++) : (h = y, 0 === Tb && d(R)); h !== y; ) g.push(h), 
                    Q.test(a.charAt(Nb)) ? (h = a.charAt(Nb), Nb++) : (h = y, 0 === Tb && d(R));
                    g !== y ? (h = n(), h !== y ? (Ob = b, c = S(c, f, h), b = c) : (Nb = b, b = C)) : (Nb = b, 
                    b = C);
                } else Nb = b, b = C; else Nb = b, b = C;
            } else Nb = b, b = C;
            return b;
        }
        function m() {
            var b;
            return a.substr(Nb, 2) === T ? (b = T, Nb += 2) : (b = y, 0 === Tb && d(U)), b === y && (a.substr(Nb, 2) === V ? (b = V, 
            Nb += 2) : (b = y, 0 === Tb && d(W)), b === y && (a.substr(Nb, 2) === X ? (b = X, 
            Nb += 2) : (b = y, 0 === Tb && d(Y)), b === y && (a.substr(Nb, 2) === Z ? (b = Z, 
            Nb += 2) : (b = y, 0 === Tb && d($)), b === y && (60 === a.charCodeAt(Nb) ? (b = _, 
            Nb++) : (b = y, 0 === Tb && d(ab)), b === y && (62 === a.charCodeAt(Nb) ? (b = bb, 
            Nb++) : (b = y, 0 === Tb && d(cb))))))), b;
        }
        function n() {
            var b, c, e, f;
            if (b = Nb, c = j(), c !== y && (Ob = b, c = db(c)), b = c, b === y) {
                if (b = Nb, 34 === a.charCodeAt(Nb) ? (c = eb, Nb++) : (c = y, 0 === Tb && d(fb)), 
                c !== y) {
                    if (e = [], gb.test(a.charAt(Nb)) ? (f = a.charAt(Nb), Nb++) : (f = y, 0 === Tb && d(hb)), 
                    f !== y) for (;f !== y; ) e.push(f), gb.test(a.charAt(Nb)) ? (f = a.charAt(Nb), 
                    Nb++) : (f = y, 0 === Tb && d(hb)); else e = C;
                    e !== y ? (34 === a.charCodeAt(Nb) ? (f = eb, Nb++) : (f = y, 0 === Tb && d(fb)), 
                    f !== y ? (Ob = b, c = ib(e), b = c) : (Nb = b, b = C)) : (Nb = b, b = C);
                } else Nb = b, b = C;
                if (b === y) {
                    if (b = Nb, c = [], jb.test(a.charAt(Nb)) ? (e = a.charAt(Nb), Nb++) : (e = y, 0 === Tb && d(kb)), 
                    e !== y) for (;e !== y; ) c.push(e), jb.test(a.charAt(Nb)) ? (e = a.charAt(Nb), 
                    Nb++) : (e = y, 0 === Tb && d(kb)); else c = C;
                    c !== y && (Ob = b, c = lb(c)), b = c;
                }
            }
            return b;
        }
        function o() {
            var b, c, e, f, h, i;
            return b = Nb, a.substr(Nb, 4) === mb ? (c = mb, Nb += 4) : (c = y, 0 === Tb && d(nb)), 
            c !== y ? (e = p(), e !== y ? (a.substr(Nb, 2) === L ? (f = L, Nb += 2) : (f = y, 
            0 === Tb && d(M)), f !== y ? (h = g(), h !== y ? (41 === a.charCodeAt(Nb) ? (i = N, 
            Nb++) : (i = y, 0 === Tb && d(O)), i !== y ? (Ob = b, c = ob(e, h), b = c) : (Nb = b, 
            b = C)) : (Nb = b, b = C)) : (Nb = b, b = C)) : (Nb = b, b = C)) : (Nb = b, b = C), 
            b;
        }
        function p() {
            var b, c, e, f;
            return b = Nb, c = j(), c !== y ? (44 === a.charCodeAt(Nb) ? (e = pb, Nb++) : (e = y, 
            0 === Tb && d(qb)), e !== y ? (f = p(), f !== y ? (Ob = b, c = rb(c, f), b = c) : (Nb = b, 
            b = C)) : (Nb = b, b = C)) : (Nb = b, b = C), b === y && (b = Nb, c = j(), c !== y && (Ob = b, 
            c = sb(c)), b = c), b;
        }
        function q() {
            var b, c, e, f, h, j;
            return b = Nb, a.substr(Nb, 5) === tb ? (c = tb, Nb += 5) : (c = y, 0 === Tb && d(ub)), 
            c !== y ? (e = i(), e !== y ? (a.substr(Nb, 2) === L ? (f = L, Nb += 2) : (f = y, 
            0 === Tb && d(M)), f !== y ? (h = g(), h !== y ? (41 === a.charCodeAt(Nb) ? (j = N, 
            Nb++) : (j = y, 0 === Tb && d(O)), j !== y ? (Ob = b, c = vb(e, h), b = c) : (Nb = b, 
            b = C)) : (Nb = b, b = C)) : (Nb = b, b = C)) : (Nb = b, b = C)) : (Nb = b, b = C), 
            b;
        }
        function r() {
            var b, c, e, f, h, i;
            return b = Nb, a.substr(Nb, 5) === tb ? (c = tb, Nb += 5) : (c = y, 0 === Tb && d(ub)), 
            c !== y ? (e = s(), e !== y ? (a.substr(Nb, 2) === L ? (f = L, Nb += 2) : (f = y, 
            0 === Tb && d(M)), f !== y ? (h = g(), h !== y ? (41 === a.charCodeAt(Nb) ? (i = N, 
            Nb++) : (i = y, 0 === Tb && d(O)), i !== y ? (Ob = b, c = wb(e, h), b = c) : (Nb = b, 
            b = C)) : (Nb = b, b = C)) : (Nb = b, b = C)) : (Nb = b, b = C)) : (Nb = b, b = C), 
            b;
        }
        function s() {
            var b, c, e, f, g, h;
            if (b = Nb, c = t(), c !== y) {
                for (e = [], Q.test(a.charAt(Nb)) ? (f = a.charAt(Nb), Nb++) : (f = y, 0 === Tb && d(R)); f !== y; ) e.push(f), 
                Q.test(a.charAt(Nb)) ? (f = a.charAt(Nb), Nb++) : (f = y, 0 === Tb && d(R));
                if (e !== y) if (44 === a.charCodeAt(Nb) ? (f = pb, Nb++) : (f = y, 0 === Tb && d(qb)), 
                f !== y) {
                    for (g = [], Q.test(a.charAt(Nb)) ? (h = a.charAt(Nb), Nb++) : (h = y, 0 === Tb && d(R)); h !== y; ) g.push(h), 
                    Q.test(a.charAt(Nb)) ? (h = a.charAt(Nb), Nb++) : (h = y, 0 === Tb && d(R));
                    g !== y ? (h = s(), h !== y ? (Ob = b, c = xb(c, h), b = c) : (Nb = b, b = C)) : (Nb = b, 
                    b = C);
                } else Nb = b, b = C; else Nb = b, b = C;
            } else Nb = b, b = C;
            return b === y && (b = Nb, c = t(), c !== y && (Ob = b, c = yb(c)), b = c), b;
        }
        function t() {
            var b, c, e, f, g, h;
            if (b = Nb, c = j(), c !== y) {
                for (e = [], Q.test(a.charAt(Nb)) ? (f = a.charAt(Nb), Nb++) : (f = y, 0 === Tb && d(R)); f !== y; ) e.push(f), 
                Q.test(a.charAt(Nb)) ? (f = a.charAt(Nb), Nb++) : (f = y, 0 === Tb && d(R));
                if (e !== y) if (a.substr(Nb, 2) === zb ? (f = zb, Nb += 2) : (f = y, 0 === Tb && d(Ab)), 
                f !== y) {
                    for (g = [], Q.test(a.charAt(Nb)) ? (h = a.charAt(Nb), Nb++) : (h = y, 0 === Tb && d(R)); h !== y; ) g.push(h), 
                    Q.test(a.charAt(Nb)) ? (h = a.charAt(Nb), Nb++) : (h = y, 0 === Tb && d(R));
                    g !== y ? (h = j(), h !== y ? (Ob = b, c = Bb(c, h), b = c) : (Nb = b, b = C)) : (Nb = b, 
                    b = C);
                } else Nb = b, b = C; else Nb = b, b = C;
            } else Nb = b, b = C;
            return b === y && (b = i()), b;
        }
        function u() {
            var b, c, e, f, h, i;
            return b = Nb, 40 === a.charCodeAt(Nb) ? (c = Cb, Nb++) : (c = y, 0 === Tb && d(Db)), 
            c !== y ? (e = g(), e !== y ? (a.substr(Nb, 8) === Eb ? (f = Eb, Nb += 8) : (f = y, 
            0 === Tb && d(Fb)), f !== y ? (h = g(), h !== y ? (41 === a.charCodeAt(Nb) ? (i = N, 
            Nb++) : (i = y, 0 === Tb && d(O)), i !== y ? (Ob = b, c = Gb(e, h), b = c) : (Nb = b, 
            b = C)) : (Nb = b, b = C)) : (Nb = b, b = C)) : (Nb = b, b = C)) : (Nb = b, b = C), 
            b;
        }
        function v() {
            var b, c, e, f, h, i, j, k;
            return b = Nb, 40 === a.charCodeAt(Nb) ? (c = Cb, Nb++) : (c = y, 0 === Tb && d(Db)), 
            c !== y ? (e = g(), e !== y ? (a.substr(Nb, 7) === Hb ? (f = Hb, Nb += 7) : (f = y, 
            0 === Tb && d(Ib)), f !== y ? (h = l(), h !== y ? (a.substr(Nb, 2) === L ? (i = L, 
            Nb += 2) : (i = y, 0 === Tb && d(M)), i !== y ? (j = g(), j !== y ? (41 === a.charCodeAt(Nb) ? (k = N, 
            Nb++) : (k = y, 0 === Tb && d(O)), k !== y ? (Ob = b, c = Jb(e, h, j), b = c) : (Nb = b, 
            b = C)) : (Nb = b, b = C)) : (Nb = b, b = C)) : (Nb = b, b = C)) : (Nb = b, b = C)) : (Nb = b, 
            b = C)) : (Nb = b, b = C), b === y && (b = Nb, 40 === a.charCodeAt(Nb) ? (c = Cb, 
            Nb++) : (c = y, 0 === Tb && d(Db)), c !== y ? (e = g(), e !== y ? (a.substr(Nb, 7) === Kb ? (f = Kb, 
            Nb += 7) : (f = y, 0 === Tb && d(Lb)), f !== y ? (h = g(), h !== y ? (41 === a.charCodeAt(Nb) ? (i = N, 
            Nb++) : (i = y, 0 === Tb && d(O)), i !== y ? (Ob = b, c = Mb(e, h), b = c) : (Nb = b, 
            b = C)) : (Nb = b, b = C)) : (Nb = b, b = C)) : (Nb = b, b = C)) : (Nb = b, b = C)), 
            b;
        }
        var w, x = arguments.length > 1 ? arguments[1] : {}, y = {}, z = {
            start: f
        }, A = f, B = function(a) {
            return new BaseRelation(a);
        }, C = y, D = /^[a-zA-Z_]/, E = {
            type: "class",
            value: "[a-zA-Z_]",
            description: "[a-zA-Z_]"
        }, F = function(a) {
            return a.join("");
        }, G = ".", H = {
            type: "literal",
            value: ".",
            description: '"."'
        }, I = function(a, b) {
            return a + "." + b.join("");
        }, J = "\\sigma[", K = {
            type: "literal",
            value: "\\sigma[",
            description: '"\\\\sigma["'
        }, L = "](", M = {
            type: "literal",
            value: "](",
            description: '"]("'
        }, N = ")", O = {
            type: "literal",
            value: ")",
            description: '")"'
        }, P = function(a, b) {
            return new Selection(a, b);
        }, Q = /^[ ]/, R = {
            type: "class",
            value: "[ ]",
            description: "[ ]"
        }, S = function(a, b, c) {
            return Function("tuple", "return " + a + b + c);
        }, T = "==", U = {
            type: "literal",
            value: "==",
            description: '"=="'
        }, V = "!=", W = {
            type: "literal",
            value: "!=",
            description: '"!="'
        }, X = "<=", Y = {
            type: "literal",
            value: "<=",
            description: '"<="'
        }, Z = ">=", $ = {
            type: "literal",
            value: ">=",
            description: '">="'
        }, _ = "<", ab = {
            type: "literal",
            value: "<",
            description: '"<"'
        }, bb = ">", cb = {
            type: "literal",
            value: ">",
            description: '">"'
        }, db = function(a) {
            return "tuple['" + a + "']";
        }, eb = '"', fb = {
            type: "literal",
            value: '"',
            description: '"\\""'
        }, gb = /^[^"]/, hb = {
            type: "class",
            value: '[^"]',
            description: '[^"]'
        }, ib = function(a) {
            return '"' + a.join("") + '"';
        }, jb = /^[0-9]/, kb = {
            type: "class",
            value: "[0-9]",
            description: "[0-9]"
        }, lb = function(a) {
            return parseInt(a.join(""), 10);
        }, mb = "\\pi[", nb = {
            type: "literal",
            value: "\\pi[",
            description: '"\\\\pi["'
        }, ob = function(a, b) {
            return new Projection(a, b);
        }, pb = ",", qb = {
            type: "literal",
            value: ",",
            description: '","'
        }, rb = function(a, b) {
            return [ a ].concat(b);
        }, sb = function(a) {
            return [ a ];
        }, tb = "\\rho[", ub = {
            type: "literal",
            value: "\\rho[",
            description: '"\\\\rho["'
        }, vb = function(a, b) {
            return new RelationRenaming(a, b);
        }, wb = function(a, b) {
            return new ColumnRenaming(a, b);
        }, xb = function(a, b) {
            return [ a ].concat(b);
        }, yb = function(a) {
            return [ a ];
        }, zb = "<-", Ab = {
            type: "literal",
            value: "<-",
            description: '"<-"'
        }, Bb = function(a, b) {
            return {
                newname: a,
                oldname: b
            };
        }, Cb = "(", Db = {
            type: "literal",
            value: "(",
            description: '"("'
        }, Eb = ")\\times(", Fb = {
            type: "literal",
            value: ")\\times(",
            description: '")\\\\times("'
        }, Gb = function(a, b) {
            return new Cross(a, b);
        }, Hb = ")\\join[", Ib = {
            type: "literal",
            value: ")\\join[",
            description: '")\\\\join["'
        }, Jb = function(a, b, c) {
            return new ThetaJoin(a, c, b);
        }, Kb = ")\\join(", Lb = {
            type: "literal",
            value: ")\\join(",
            description: '")\\\\join("'
        }, Mb = function(a, b) {
            return new NaturalJoin(a, b);
        }, Nb = 0, Ob = 0, Pb = 0, Qb = {
            line: 1,
            column: 1,
            seenCR: !1
        }, Rb = 0, Sb = [], Tb = 0;
        if ("startRule" in x) {
            if (!(x.startRule in z)) throw new Error("Can't start parsing from rule \"" + x.startRule + '".');
            A = z[x.startRule];
        }
        if (w = A(), w !== y && Nb === a.length) return w;
        throw w !== y && Nb < a.length && d({
            type: "end",
            description: "end of input"
        }), e(null, Sb, Rb);
    }
    return a(b, Error), {
        SyntaxError: b,
        parse: c
    };
}(), window.onload = function() {
    makeTablesExpendable(), document.getElementById("computeitlikeabauss").onclick = execQuery, 
    document.getElementById("input").onkeypress = function(a) {
        a || (a = window.event);
        var b = a.keyCode || a.which;
        "13" == b && execQuery();
    };
};